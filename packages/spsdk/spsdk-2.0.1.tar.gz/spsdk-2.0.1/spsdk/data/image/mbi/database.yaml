# Copyright 2021-2023 NXP
#
# SPDX-License-Identifier: BSD-3-Clause

map_tables:
  targets:
    xip:
      [
        xip,
        Internal flash (XIP),
        External flash (XIP),
        Internal Flash (XIP),
        External Flash (XIP),
      ]
    load_to_ram: [load-to-ram, RAM, ram]

  authentication:
    plain: [plain, Plain]
    crc: [crc, CRC]
    signed: [signed, Signed]
    nxp_signed: [signed-nxp, NXP Signed, NXP signed]
    encrypted: [signed-encrypted, Encrypted + Signed, encrypted]

mbi_classes:
  Mbi_PlainXip:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_ExportMixinAppTrustZone
  Mbi_CrcXip:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_CrcRam:
    image_type: CRC_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinLoadAddress
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_SignedXip:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinCertBlockV1
      - Mbi_ExportMixinAppTrustZoneCertBlock
      - Mbi_ExportMixinRsaSign
  Mbi_SignedRam:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinLoadAddress
      - Mbi_MixinCertBlockV1
      - Mbi_ExportMixinAppTrustZoneCertBlock
      - Mbi_ExportMixinRsaSign
  Mbi_PlainRamRtxxx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinLoadAddress
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZone
  Mbi_PlainSignedRamRtxxx:
    image_type: SIGNED_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinRelocTable
      - Mbi_MixinLoadAddress
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinCertBlockV1
      - Mbi_MixinHmacMandatory
      - Mbi_MixinKeyStore
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZoneCertBlock
      - Mbi_ExportMixinRsaSign
      - Mbi_ExportMixinHmacKeyStoreFinalize
  Mbi_CrcRamRtxxx:
    image_type: CRC_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinRelocTable
      - Mbi_MixinLoadAddress
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_EncryptedRamRtxxx:
    image_type: ENCRYPTED_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinRelocTable
      - Mbi_MixinLoadAddress
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinCertBlockV1
      - Mbi_MixinHwKey
      - Mbi_MixinKeyStore
      - Mbi_MixinHmacMandatory
      - Mbi_MixinCtrInitVector
      - Mbi_ExportMixinAppTrustZoneCertBlockEncrypt
      - Mbi_ExportMixinEncrypt
      - Mbi_ExportMixinRsaSign
      - Mbi_ExportMixinHmacKeyStoreFinalize
  Mbi_PlainXipRtxxx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZone
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZone
  Mbi_PlainSignedXipRtxxx:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinTrustZone
      - Mbi_MixinCertBlockV1
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZoneCertBlock
      - Mbi_ExportMixinRsaSign
  Mbi_CrcXipRtxxx:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinTrustZone
      - Mbi_MixinHwKey
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainRamLpc55s3x:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinImageVersion
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_ExportMixinAppTrustZone
  Mbi_CrcRamLpc55s3x:
    image_type: CRC_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinImageVersion
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainXipSignedLpc55s3x:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinImageVersion
      - Mbi_MixinIvt
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifest
      - Mbi_MixinLoadAddress
      - Mbi_MixinFwVersion
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_CrcXipLpc55s3x:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinImageVersion
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainXipKw45xx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinImageSubType
      - Mbi_ExportMixinAppTrustZone
  Mbi_PlainXipSignedKw45xx:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifestDigest
      - Mbi_MixinNoSignature
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_PlainXipSignedNxpKw45xx:
    image_type: SIGNED_XIP_NXP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifestDigest
      - Mbi_MixinImageSubType
      - Mbi_MixinNoSignature
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_CrcXipKw45xx:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinImageSubType
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainRamMcxNx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
  Mbi_PlainXipMcxNx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
  Mbi_CrcRamMcxNx:
    image_type: CRC_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_CrcXipMcxNx:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_SignedRamMcxNx:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifestMcxNx
      - Mbi_MixinImageSubType
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_MixinFwVersion
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_SignedXipMcxNx:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinLoadAddress
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifestMcxNx
      - Mbi_MixinImageSubType
      - Mbi_MixinImageVersion
      - Mbi_MixinFwVersion
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_SignedVx:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinBca
      - Mbi_MixinCertBlockVx
      - Mbi_ExportMixinAppBca
      - Mbi_ExportMixinEccSignVx
  Mbi_PlainRamRw61x:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
  Mbi_CrcRamRw61x:
    image_type: CRC_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainSignedRamRw61x:
    image_type: SIGNED_RAM_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifest
      - Mbi_MixinLoadAddress
      - Mbi_MixinFwVersion
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_PlainExtXipSignedRw61x:
    image_type: SIGNED_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinCertBlockV21
      - Mbi_MixinManifest
      - Mbi_MixinLoadAddress
      - Mbi_MixinFwVersion
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppCertBlockManifest
      - Mbi_ExportMixinEccSign
  Mbi_CrcExtXipRw61x:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinTrustZoneMandatory
      - Mbi_MixinLoadAddress
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinAppTrustZone
      - Mbi_ExportMixinCrcSign
  Mbi_PlainXipMcxAx:
    image_type: PLAIN_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinApp
  Mbi_CrcXipMcxAx:
    image_type: CRC_XIP_IMAGE
    mixins:
      - Mbi_MixinApp
      - Mbi_MixinIvt
      - Mbi_MixinImageVersion
      - Mbi_ExportMixinApp
      - Mbi_ExportMixinCrcSign

devices:
  lpc55s0x:
    images:
      xip:
        plain: Mbi_PlainXipRtxxx
        crc: Mbi_CrcXipRtxxx
        signed: Mbi_PlainSignedXipRtxxx
      load_to_ram:
        crc: Mbi_CrcRam
        signed: Mbi_SignedRam

  lpc550x:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
      load_to_ram:
        crc: Mbi_CrcRam

  lpc55s1x:
    images:
      xip:
        plain: Mbi_PlainXipRtxxx
        crc: Mbi_CrcXipRtxxx
        signed: Mbi_PlainSignedXipRtxxx
      load_to_ram:
        crc: Mbi_CrcRam
        signed: Mbi_SignedRam

  lpc551x:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
      load_to_ram:
        crc: Mbi_CrcRam

  lpc55s2x:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
        signed: Mbi_SignedXip
      load_to_ram:
        crc: Mbi_CrcRam
        signed: Mbi_SignedRam

  lpc552x:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
      load_to_ram:
        crc: Mbi_CrcRam

  lpc55s6x:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
        signed: Mbi_SignedXip
      load_to_ram:
        crc: Mbi_CrcRam
        signed: Mbi_SignedRam

  nhs52sxx:
    images:
      xip:
        plain: Mbi_PlainXip
        crc: Mbi_CrcXip
        signed: Mbi_SignedXip
      load_to_ram:
        crc: Mbi_CrcRam
        signed: Mbi_SignedRam

  rt5xx:
    images:
      xip:
        plain: Mbi_PlainXipRtxxx
        crc: Mbi_CrcXipRtxxx
        signed: Mbi_PlainSignedXipRtxxx
      load_to_ram:
        plain: Mbi_PlainRamRtxxx
        crc: Mbi_CrcRamRtxxx
        signed: Mbi_PlainSignedRamRtxxx
        encrypted: Mbi_EncryptedRamRtxxx

  rt6xx:
    images:
      xip:
        plain: Mbi_PlainXipRtxxx
        crc: Mbi_CrcXipRtxxx
        signed: Mbi_PlainSignedXipRtxxx
      load_to_ram:
        plain: Mbi_PlainRamRtxxx
        crc: Mbi_CrcRamRtxxx
        signed: Mbi_PlainSignedRamRtxxx
        encrypted: Mbi_EncryptedRamRtxxx

  lpc55s3x:
    images:
      xip:
        plain: Mbi_PlainRamLpc55s3x
        crc: Mbi_CrcXipLpc55s3x
        signed: Mbi_PlainXipSignedLpc55s3x
      load_to_ram:
        plain: Mbi_PlainRamLpc55s3x
        crc: Mbi_CrcRamLpc55s3x

  kw45xx:
    images:
      xip:
        plain: Mbi_PlainXipKw45xx
        crc: Mbi_CrcXipKw45xx
        signed: Mbi_PlainXipSignedKw45xx
        nxp_signed: Mbi_PlainXipSignedNxpKw45xx

  k32w1xx:
    images:
      xip:
        plain: Mbi_PlainXipKw45xx
        crc: Mbi_CrcXipKw45xx
        signed: Mbi_PlainXipSignedKw45xx
        nxp_signed: Mbi_PlainXipSignedNxpKw45xx

  lpc553x:
    images:
      xip:
        plain: Mbi_PlainRamLpc55s3x
        crc: Mbi_CrcXipLpc55s3x
      load_to_ram:
        plain: Mbi_PlainRamLpc55s3x
        crc: Mbi_CrcRamLpc55s3x

  mcxn9xx:
    images:
      xip:
        plain: Mbi_PlainXipMcxNx
        crc: Mbi_CrcXipMcxNx
        signed: Mbi_SignedXipMcxNx
      load_to_ram:
        plain: Mbi_PlainRamMcxNx
        crc: Mbi_CrcRamMcxNx
        signed: Mbi_SignedRamMcxNx

  mc56f81xxx:
    images:
      xip:
        signed: Mbi_SignedVx

  mwct20d2x:
    images:
      xip:
        signed: Mbi_SignedVx

  rw61x:
    images:
      xip:
        plain: Mbi_PlainRamRw61x
        crc: Mbi_CrcExtXipRw61x
        signed: Mbi_PlainExtXipSignedRw61x
      load_to_ram:
        plain: Mbi_PlainRamRw61x
        crc: Mbi_CrcRamRw61x
        signed: Mbi_PlainSignedRamRw61x

  mcxa1xx:
    images:
      xip:
        plain: Mbi_PlainXipMcxAx
        crc: Mbi_CrcXipMcxAx
