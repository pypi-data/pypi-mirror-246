"use strict";(self.webpackChunk_jupytercad_jupytercad_lab=self.webpackChunk_jupytercad_jupytercad_lab||[]).push([[966],{6966:(e,t,a)=>{a.r(t),a.d(t,{default:()=>C});var o=a(3205),r=a(9053),n=a(5409),d=a(4224),s=a(967),i=a(1140),l=a(7749),c=a(125),u=a(5633),p=a(8778),g=a(332);class y extends g.JupyterYModel{}class h extends p.Panel{constructor(e){super(),this.onResize=()=>{this._jcadWidget&&u.MessageLoop.sendMessage(this._jcadWidget,p.Widget.ResizeMessage.UnknownSize)},this.addClass("jupytercad-notebook-widget"),this._jcadWidget=new d.JupyterCadPanel(e),this.addWidget(this._jcadWidget)}}const M={id:"jupytercad:yjswidget-plugin",autoStart:!0,requires:[s.IJCadWorkerRegistryToken],optional:[g.IJupyterYWidgetManager,r.ITranslator],activate:(e,t,a,o)=>{if(!a)return void console.error("Missing IJupyterYWidgetManager token!");const n=null!=o?o:r.nullTranslator;a.registerWidget("@jupytercad:widget",class extends y{ydocFactory(t){const{path:a,format:o,contentType:r}=t;this.jupyterCADModel=new s.JupyterCadModel({});const d=e.serviceManager.user;if(a&&o&&r){const e=c.ServerConnection.makeSettings(),t=l.URLExt.join(e.wsUrl,"api/collaboration/room"),s=new i.WebSocketProvider({url:t,path:a,format:o,contentType:r,model:this.jupyterCADModel.sharedModel,user:d,translator:n.load("jupyterlab")});this.jupyterCADModel.disposed.connect((()=>{s.dispose()}))}else{const e=this.jupyterCADModel.sharedModel.awareness,t=t=>{e.setLocalStateField("user",t.identity)};d.ready.then((()=>{t(d)})).catch((e=>console.error(e))),d.userChanged.connect(t,this)}return this.jupyterCADModel.sharedModel.ydoc}},class{constructor(e,a){this.yModel=e,this.node=a;const o=new h({model:e.jupyterCADModel,workerRegistry:t});u.MessageLoop.sendMessage(o,p.Widget.Msg.BeforeAttach),a.appendChild(o.node),u.MessageLoop.sendMessage(o,p.Widget.Msg.AfterAttach)}})}},j="jupytercad",C=[{id:"jupytercad:lab:main-menu",autoStart:!0,requires:[s.IJupyterCadDocTracker],optional:[n.IMainMenu,r.ITranslator],activate:(e,t,a,o)=>{console.log("jupytercad:lab:main-menu is activated!"),o=null!=o?o:r.nullTranslator;(0,d.addCommands)(e,t,o),a&&function(e,t){e.editMenu.undoers.redo.add({id:d.CommandIDs.redo,isEnabled:t}),e.editMenu.undoers.undo.add({id:d.CommandIDs.undo,isEnabled:t})}(a,(()=>null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget))}},{id:"jupytercad:lab:controlpanel",autoStart:!0,requires:[o.ILayoutRestorer,s.IJupyterCadDocTracker,s.IAnnotationToken],activate:(e,t,a,o)=>{const r=new d.ControlPanelModel({tracker:a}),n=new d.LeftPanelWidget({model:r,annotationModel:o,tracker:a});n.id="jupytercad::leftControlPanel",n.title.caption="JupyterCad Control Panel",n.title.icon=d.jcLightIcon;const s=new d.RightPanelWidget({model:r});s.id="jupytercad::rightControlPanel",s.title.caption="JupyterCad Control Panel",s.title.icon=d.jcLightIcon,t&&(t.add(n,j),t.add(s,j)),e.shell.add(n,"left",{rank:2e3}),e.shell.add(s,"right",{rank:2e3})}},M]}}]);