(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[694],{96795:function(e,n,t){var r=t(36740)(function(e,n,t){e[t?0:1].push(n)},function(){return[[],[]]});e.exports=r},78945:function(e,n,t){"use strict";t.d(n,{_:function(){return useCanSeeConfig}});var r=t(73235),u=t(40794),i=t(60138);function _templateObject(){var e=(0,r._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return _templateObject=function(){return e},e}var useCanSeeConfig=function(){var e=(0,u.a)(o).data;return!!(null==e?void 0:e.instance.hasInfo)},o=(0,i.Ps)(_templateObject())},46928:function(e,n,t){"use strict";t.d(n,{Q1:function(){return x},Qf:function(){return useSelectedRunsTab},zc:function(){return useRunListTabs}});var r=t(85333),u=t(6692),i=t(58467),o=t(73235),s=t(82550),a=t(52322),l=t(40794),c=t(60138),d=t(9001),f=t(25195),m=t(18149),p=t.n(m),v=t(2784),h=t(7267),R=t(35505),_=t(28252),j=t(16148),g=t(6315),b=t(49313);function _templateObject(){var e=(0,o._)(["\n          background-color: ",";\n          color: ",";\n\n          &&:hover {\n            background-color: ",";\n            color: ",";\n          }\n        "]);return _templateObject=function(){return e},e}function _templateObject1(){var e=(0,o._)(["\n          background-color: ",";\n        "]);return _templateObject1=function(){return e},e}function _templateObject2(){var e=(0,o._)(["\n  color: ",";\n\n  &&:hover {\n    color: ",";\n  }\n\n  ","\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){var e=(0,o._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return _templateObject3=function(){return e},e}var getDocumentTitle=function(e){switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},useRunListTabs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.a)(y,{variables:{queuedFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(g.sy)}),inProgressFilter:(0,u._)((0,r._)({},e),{statuses:Array.from(g.Ys)})}}),t=n.data,o=v.useMemo(function(){var e,n;return{queuedCount:(null==t?void 0:null===(e=t.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?t.queuedCount.count:null,inProgressCount:(null==t?void 0:null===(n=t.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?t.inProgressCount.count:null}},[t]),c=o.queuedCount,f=o.inProgressCount,m=(0,i._)((0,b.oD)(),1)[0],p=useSelectedRunsTab(m);(0,_.j)(getDocumentTitle(p));var urlForStatus=function(e){var n=m.filter(function(e){return"status"!==e.token}),t=e.map(function(e){return{token:"status",value:e}});return(0,b.it)((0,s._)(t).concat((0,s._)(n)))};return{tabs:(0,a.jsxs)(d.zH,{children:[(0,a.jsx)(x,{to:urlForStatus([]),id:"all",$active:"all"===p,children:"All runs"}),(0,a.jsxs)(x,{to:urlForStatus(Array.from(g.sy)),id:"queued",$active:"queued"===p,children:["Queued (",null!=c?c:"indeterminate",")"]}),(0,a.jsxs)(x,{to:urlForStatus(Array.from(g.Ys)),id:"in-progress",$active:"in-progress"===p,children:["In progress (",null!=f?f:"indeterminate",")"]}),(0,a.jsx)(x,{to:urlForStatus(Array.from(g.hd)),id:"failed",$active:"failed"===p,children:"Failed"}),(0,a.jsx)(x,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===p,children:"Scheduled"})]}),queryResult:n}},x=(0,R.ZP)(j.A).withConfig({componentId:"sc-d4e82ccc-0"})(_templateObject2(),(0,f.$)(),(0,f.$)(),function(e){return e.$active?(0,R.iv)(_templateObject(),(0,f.AU)(),(0,f.Ep)(),(0,f.AU)(),(0,f.Ep)()):(0,R.iv)(_templateObject1(),(0,f.v8)())}),useSelectedRunsTab=function(e){var n=(0,h.TH)().pathname;if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";var t=new Set(e.filter(function(e){return"status"===e.token}).map(function(e){return e.value}));return p()(g.sy,t)?"queued":p()(g.Ys,t)?"in-progress":p()(g.hd,t)?"failed":"all"},y=(0,c.Ps)(_templateObject3())},22694:function(e,n,t){"use strict";t.r(n),t.d(n,{RUNS_ROOT_QUERY:function(){return W},RunsRoot:function(){return RunsRoot},default:function(){return J}});var r=t(85333),u=t(58467),i=t(73235),o=t(82550),s=t(52322),a=t(60138),l=t(18399),c=t(21221),d=t(28888),f=t(17131),m=t(81308),p=t(92364),v=t(12084),h=t(83302),R=t(96795),_=t.n(R),j=t(2784),g=t(91195),b=t(55237),x=t(68028),y=t(28316);function DOMNodeHost(e){var n=e.node,t=j.useRef(null);return j.useLayoutEffect(function(){var e=t.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),function(){null==e||e.removeChild(n)}}},[n]),(0,s.jsx)("div",{ref:t})}var T=t(47803),C=new(function(){function PointToPointInstrumentation(){(0,T._)(this,PointToPointInstrumentation),this.traces={}}var e=PointToPointInstrumentation.prototype;return e.startTrace=function(e,n){if(!e){console.error("Trace ID is required to start a trace.");return}if(!this.traces[e]){var t=performance.now();this.traces[e]={name:n,startTime:t,endTime:null}}},e.endTrace=function(e){if(e){var n=this.traces[e];n&&!n.endTime&&(n.endTime=performance.now(),document.dispatchEvent(new CustomEvent("PerformanceTrace",{detail:n})))}},PointToPointInstrumentation}()),O=0,E=t(90894),q=t(19358),P=t(40794),A=t(9676),F=t(47933),w=t(74897),k=t(78945);function _templateObject(){var e=(0,i._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return _templateObject=function(){return e},e}var QueuedRunsBanners=function(){var e=(0,k._)();return(0,s.jsxs)(l.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,s.jsx)(A.b,{intent:"info",title:(0,s.jsx)(F.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,s.jsx)(QueueDaemonAlert,{})]})},QueueDaemonAlert=function(){var e=(0,P.a)(S).data,n=j.useContext(w.N).pageTitle,t=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==t?void 0:t.required)&&!(null==t?void 0:t.healthy)?(0,s.jsx)(A.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,s.jsxs)("div",{children:["View ",(0,s.jsx)(F.rU,{to:"/health",children:n})," for details."]})}):null},S=(0,a.Ps)(_templateObject()),$=t(46928),I=t(6315),Q=t(64107),B=t(38917),D=t(49313),N=t(81862),H=t(22970),U=t(56675),Y=t(9001),L=t(18149),M=t.n(L),z=t(16322);function TerminateAllRunsButton_templateObject(){var e=(0,i._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return TerminateAllRunsButton_templateObject=function(){return e},e}var TerminateAllRunsButton=function(e){var n,t=e.refetch,r=e.filter,i=e.disabled,o=(0,u._)(j.useState(null),2),a=o[0],l=o[1],c=(0,U.x)(),d=(n=(0,N._)(function(){var e;return(0,H.Jh)(this,function(n){switch(n.label){case 0:return[4,c.query({query:V,variables:{filter:r}})];case 1:return l("Runs"===(e=n.sent()).data.pipelineRunsOrError.__typename?Object.fromEntries(e.data.pipelineRunsOrError.results.map(function(e){return[e.id,e.canTerminate]})):{}),[2]}})}),function(){return n.apply(this,arguments)});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.A,{isOpen:null!==a,selectedRuns:a||{},selectedRunsAllQueued:M()(r,{statuses:Array.from(I.sy)}),onClose:function(){return l(null)},onComplete:function(){return t()}}),(0,s.jsx)(Y.zx,{intent:"danger",outlined:!0,disabled:i,onClick:d,children:"Terminate allâ€¦"})]})},V=(0,a.Ps)(TerminateAllRunsButton_templateObject()),Z=t(65767);function RunsRoot_templateObject(){var e=(0,i._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return RunsRoot_templateObject=function(){return e},e}var RunsRoot=function(){var e,n,t,i,a,actionBar=function(){var e,n,t,r;return(0,s.jsxs)(l.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,s.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[G,es]}),"queued"===N?(0,s.jsx)(TerminateAllRunsButton,{refetch:en.refetch,filter:{statuses:Array.from(I.sy)},disabled:(null===(e=K.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=K.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===N?(0,s.jsx)(TerminateAllRunsButton,{refetch:en.refetch,filter:{statuses:Array.from(I.Ys)},disabled:(null===(t=K.data)||void 0===t?void 0:t.inProgressCount.__typename)!=="Runs"||(null===(r=K.data)||void 0===r?void 0:r.inProgressCount.count)===0}):void 0]})};(0,x.Px)();var R=(e="RunsRoot",n=j.useMemo(function(){return"".concat(O++,":").concat(e)},[e]),C.startTrace(n,e),j.useMemo(function(){return{endTrace:C.endTrace.bind(C,n)}},[n])),g=(0,u._)((0,D.oD)(),2),T=g[0],P=g[1],A=(0,D.VH)(T),F=(0,Z.l)({nextCursorForResult:function(e){var n;if("Runs"===e.pipelineRunsOrError.__typename)return null===(n=e.pipelineRunsOrError.results[24])||void 0===n?void 0:n.id},getResultArray:function(e){return e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[]},variables:{filter:A},query:W,pageSize:25}),w=F.queryResult,k=F.paginationProps,S=(0,b.C4)(w,b.dT),N=(0,$.Qf)(T),H="all"!==N,U=(0,u._)(_()(T,function(e){return"status"===e.token}),2),Y=U[0],L=U[1],M=j.useCallback(function(e){H?P((0,o._)(Y).concat((0,o._)(e))):P(e)},[P,H,Y]),z=j.useCallback(function(e){var n=(0,c.HY)(e);L.some(function(e){return(0,c.HY)(e)===n})||M((0,o._)(L).concat([e]))},[L,M]),V=j.useMemo(function(){var e=["tag","snapshotId","id","job","pipeline","partition","backfill"];return H||e.push("status"),e},[H]),J=j.useMemo(function(){return H?T.filter(function(e){return"status"!==e.token}):T},[T,H]),X=(0,$.zc)(A),G=X.tabs,K=X.queryResult,ee=(0,b.C4)(K,b.dT),en=(0,b.V5)(ee,S),et=(0,D.Vv)({tokens:J,onChange:M,enabledFilters:V}),er=et.button,eu=et.activeFiltersJsx,ei=(0,u._)((i=(t=(0,u._)(j.useState(null),2))[0],a=t[1],j.useLayoutEffect(function(){a(function(e){return null===e?document.createElement("div"):e})},[]),[i?(0,y.createPortal)(er,i):null,i?(0,s.jsx)(DOMNodeHost,{node:i}):null]),2),eo=ei[0],es=ei[1];return(0,s.jsxs)(d.T,{children:[(0,s.jsx)(f.m,{title:(0,s.jsx)(m.X6,{children:"Runs"}),right:(0,s.jsx)(b.xi,{refreshState:en})}),eo,(0,s.jsx)(B.Lw.Provider,{value:{refetch:w.refetch},children:(0,s.jsx)(E.g,{queryResult:w,allowStaleData:!0,renderError:function(e){var n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,s.jsxs)(l.x,{flex:{direction:"column",gap:32},padding:{vertical:8,left:24,right:12},children:[actionBar(),(0,s.jsx)(p.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:function(e){var n=e.pipelineRunsOrError;return"Runs"!==n.__typename?(0,s.jsx)(l.x,{padding:{vertical:64},children:(0,s.jsx)(p.t,{icon:"error",title:"Query Error",description:n.message})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(RunsRootPerformanceEmitter,{trace:R}),(0,s.jsx)(q.Y,{$top:0,children:(0,s.jsx)(Q.AL,{runs:n.results.slice(0,25),onAddTag:z,filter:A,actionBarComponents:actionBar(),belowActionBarComponents:"queued"===N||eu.length?(0,s.jsxs)(s.Fragment,{children:["queued"===N&&(0,s.jsx)(QueuedRunsBanners,{}),eu.length>0&&(0,s.jsxs)(s.Fragment,{children:[eu,(0,s.jsx)(v.Z,{onClick:function(){return M([])},children:"Clear all"})]})]}):null})}),n.results.length>0?(0,s.jsx)("div",{style:{marginTop:"16px"},children:(0,s.jsx)(h.pI,(0,r._)({},k))}):null]})}})})]})},RunsRootPerformanceEmitter=function(e){var n=e.trace;return j.useLayoutEffect(function(){n.endTrace()},[n]),null},J=RunsRoot,W=(0,a.Ps)(RunsRoot_templateObject(),Q.ZZ,g.B)}}]);
//# sourceMappingURL=694.cdf08a9505d8edc0.js.map