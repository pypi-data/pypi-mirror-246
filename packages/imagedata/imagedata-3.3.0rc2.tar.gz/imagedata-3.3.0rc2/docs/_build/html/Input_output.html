<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Input/output &mdash; imagedata 3.2.4dev0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Sorting" href="Sorting.html" />
    <link rel="prev" title="Motivation and goals" href="Introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> imagedata
          </a>
              <div class="version">
                3.2.4dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="UserGuide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="Collections.html">Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Notebook.html">Jupyter Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="Introduction.html">Motivation and goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="Introduction.html#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="Introduction.html#series-class">Series Class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Input/output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#local-files">Local files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zip-file">ZIP file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xnat">XNAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dicom">DICOM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Sorting.html">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="DICOMAttributes.html">DICOM Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="CommandLine.html">Console Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="APIReference.html">API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DeveloperDocumentation.html">Developer Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">imagedata</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="UserGuide.html">User Guide</a> &raquo;</li>
      <li>Input/output</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Input_output.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="input-output">
<span id="id1"></span><h1>Input/output<a class="headerlink" href="#input-output" title="Permalink to this headline"></a></h1>
<div class="section" id="local-files">
<h2>Local files<a class="headerlink" href="#local-files" title="Permalink to this headline"></a></h2>
<dl class="simple">
<dt>Input:</dt><dd><p>Read a file by specifying a path name, or read a directory by giving a directory name.</p>
<ul class="simple">
<li><p>file.mha</p></li>
<li><p>/home/dicom/file.mha</p></li>
<li><p><a class="reference external" href="file:///home/dicom/file.mha">file:///home/dicom/file.mha</a></p></li>
<li><p>dir</p></li>
<li><p>/home/dicom/dir</p></li>
<li><p><a class="reference external" href="file:///home/dicom/dir">file:///home/dicom/dir</a></p></li>
</ul>
</dd>
</dl>
<p>When reading a directory, every file inside will be scanned and combined into a Series instance.
See <a class="reference internal" href="Sorting.html#sorting"><span class="std std-ref">Sorting</span></a> for details on sorting images.</p>
<dl class="simple">
<dt>Write:</dt><dd><p>When writing, the provided path name will be taken as a (new) directory, and images file(s)
are added to that directory.</p>
</dd>
</dl>
</div>
<div class="section" id="zip-file">
<h2>ZIP file<a class="headerlink" href="#zip-file" title="Permalink to this headline"></a></h2>
<p>A zip file can contain image files.</p>
<dl>
<dt>Read:</dt><dd><p>Access files in an existing zip file. Selected files or directories can be specified:</p>
<ul class="simple">
<li><p>file.zip</p></li>
<li><p>file.zip?time</p></li>
</ul>
<p>The latter example will read the time/ directory in the zip file.</p>
</dd>
<dt>Write:</dt><dd><p>Files can be added to a zip file. When the zip file does not exist, it will be created prior to writing.</p>
</dd>
</dl>
</div>
<div class="section" id="xnat">
<h2>XNAT<a class="headerlink" href="#xnat" title="Permalink to this headline"></a></h2>
<p>Image data in XNAT can be accessed. Reading data will fetch the image data and construct a Series instance.
Writing a Series instance will create a new scan in the XNAT subject and experiment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="s1">&#39;xnat://xnat.server/project/subject/experiment/scan&#39;</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">seriesNumber</span> <span class="o">=</span> <span class="mi">9999</span>
<span class="n">img</span><span class="o">.</span><span class="n">seriesDescription</span> <span class="o">=</span> <span class="s1">&#39;New Series&#39;</span>
<span class="n">img</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;xnat://xnat.server/project/subject/experiment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to access the XNAT server, you typically need to authenticate.
Handling authenticating is outside the scope of imagedata.
See <a class="reference external" href="https://xnat.readthedocs.io/en/latest/static/tutorial.html#credentials">https://xnat.readthedocs.io/en/latest/static/tutorial.html#credentials</a> for details.
On a Linux system, authentication can be handled by adding</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">machine</span> <span class="n">xnat</span><span class="o">.</span><span class="n">server</span>
 <span class="n">login</span> <span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span>
 <span class="n">password</span> <span class="o">&lt;</span><span class="n">pwd</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>to a ~/.netrc file. Remember to restrict access to yourself only:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chmod <span class="m">0600</span> ~/.netrc
</pre></div>
</div>
</div>
<div class="section" id="dicom">
<h2>DICOM<a class="headerlink" href="#dicom" title="Permalink to this headline"></a></h2>
<dl>
<dt>Read:</dt><dd><p>DICOM data can be read from a DICOM archive which supports the C-GET method.</p>
<p>A DICOM series can be specified by providing patient ID, study and series instance UIDs.
Instead of study instance UID, the accession number can be used.
A series can be specified by providing the series number instead of series instance UID.</p>
<p>Consult the DICOM Conformance Statement of the DICOM archive to determine whether
C-GET is supported.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">patID</span> <span class="o">=</span> <span class="s1">&#39;123456&#39;</span>
<span class="n">stuInsUID</span> <span class="o">=</span> <span class="s1">&#39;1.2.3.4&#39;</span>
<span class="n">serInsUID</span> <span class="o">=</span> <span class="s1">&#39;1.2.3.4.5&#39;</span>
<span class="c1"># A Series can be specified by providing Study and Series instance UID</span>
<span class="n">si1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="s1">&#39;dicom://localhost:11112/Temp/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">patID</span><span class="p">,</span> <span class="n">stuInsUID</span><span class="p">,</span> <span class="n">serInsUID</span>
<span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">si1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">si1</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span> <span class="n">si1</span><span class="o">.</span><span class="n">patientName</span><span class="p">,</span> <span class="n">si1</span><span class="o">.</span><span class="n">accessionNumber</span><span class="p">,</span> <span class="n">si1</span><span class="o">.</span><span class="n">seriesNumber</span><span class="p">)</span>

<span class="n">accno</span> <span class="o">=</span> <span class="s1">&#39;98765&#39;</span>
<span class="n">serNum</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># A Series can also be specified by providing accession number and series number</span>
<span class="n">si2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="s1">&#39;dicom://localhost:11112/Temp/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">patID</span><span class="p">,</span> <span class="n">accno</span><span class="p">,</span> <span class="n">serNum</span>
<span class="p">))</span>
</pre></div>
</div>
<dl class="simple">
<dt>Write:</dt><dd><p>A Series instance can be sent to a DICOM archive using its write() method.
There is no need to specify a path name on the DICOM archive.
The image will be associated with the correct patient and study, according to the study, series and instance UIDs
present in the Series instance.</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write Series instance to DICOM Archive</span>
<span class="c1"># DICOM Archive address: dicom.server</span>
<span class="c1"># DICOM Archive port number: 11112</span>
<span class="c1"># DICOM Archive application entity title: AET</span>
<span class="n">img</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dicom://dicom.server:11112/AET&#39;</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dicom&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>It is mandatory that a full DICOM header is associated with the Series instance.
This will be the case when the Series instance was loaded from DICOM data in the first place.
When no DICOM header is present, a DICOM template can be used to construct a complete DICOM header:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch PostScript file, add DICOM template, and send to DICOM archive</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="s1">&#39;postscript.ps&#39;</span><span class="p">,</span> <span class="n">template</span><span class="o">=</span><span class="s1">&#39;dicom/data&#39;</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dicom://dicom.server:11112/AET&#39;</span><span class="p">,</span> <span class="n">formats</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dicom&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Introduction.html" class="btn btn-neutral float-left" title="Motivation and goals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Sorting.html" class="btn btn-neutral float-right" title="Sorting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2023, Erling Andersen, Haukeland University Hospital, Bergen, Norway.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>