<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Motivation and goals &mdash; imagedata 3.2.4dev0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Input/output" href="Input_output.html" />
    <link rel="prev" title="Jupyter Notebook" href="Notebook.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> imagedata
          </a>
              <div class="version">
                3.2.4dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="UserGuide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorial.html">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="Collections.html">Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="Notebook.html">Jupyter Notebook</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Motivation and goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#series-class">Series Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="Input_output.html">Input/output</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sorting.html">Sorting</a></li>
<li class="toctree-l2"><a class="reference internal" href="DICOMAttributes.html">DICOM Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="CommandLine.html">Console Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="Examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="APIReference.html">API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DeveloperDocumentation.html">Developer Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">imagedata</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="UserGuide.html">User Guide</a> &raquo;</li>
      <li>Motivation and goals</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="motivation-and-goals">
<span id="introduction"></span><h1>Motivation and goals<a class="headerlink" href="#motivation-and-goals" title="Permalink to this headline"></a></h1>
<p>DICOM is the standard image format and protocol when working with
medical images in the clinic. Python has support for reading and writing
DICOM images through the use of python packages, e.g. pydicom or GDCM.
These packages, however, leave the reading and sorting of multiple files
to the user.  Also, they do not easily provide access to medical images
stored in other formats: NIfTI and ITK to name a few.</p>
<p>When setting up pipelines to process clinical data, patient information
should be maintained throughout to maintain patient safety. If the
process involves DICOM data only, this requirement is easily fulfilled.
However, some popular image processing systems require formats that do
not maintain patient information. The ability to attach DICOM header
data to these other formats let the user exploit a wider set of image
processing software.</p>
<p><em>Imagedata</em> extends NumPy arrays with DICOM information and functionality.
Additionally, importing and exporting images to other image formats is available
through a plugin architecture.</p>
<p><em>Imagedata</em> as a Python package provides functions which supports developing Python
applications, including reading and writing complete image series, and displaying
image series using a simple viewer.</p>
</div>
<div class="section" id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this headline"></a></h1>
<p>The <strong>Series</strong> class is subclassed from <strong>numpy.ndarray</strong>, and as such inherits the methods
of ndarray. Examples are the <strong>shape</strong> and <strong>dtype</strong> attributes.
In addition, Series objects add selected attributes, like
<strong>spacing</strong>, <strong>sliceLocations</strong>, <strong>patientName</strong>, <strong>studyInstanceUID</strong>.
DICOM reading and writing depends on the <em>pydicom</em> and <em>pynetdicom</em> libraries.</p>
<p>The Series object can be instantiated from a NumPy array, from a DICOM source, or from some
other image format source.
The Series object maintains header data as close to the DICOM standard as possible,
describing demographic data, study data and geometric data.
When importing or exporting images to other formats, <em>imagedata</em> will convert
header data when supported be these other formats.
A DICOM source can be used as a template to construct a DICOM header for
non-DICOM data. By using the existing Study Instance UID and constructing a new
Series Instance UID, the new Series object can be imported into a DICOM server (PACS) as
a new series in an existing study.</p>
<p>One particular property of <strong>Series</strong> is the <strong>axes</strong> property.
<strong>Axes</strong> defines each dimension of the <strong>Series</strong> multi-dimensional array.
This might be axes in the spatial domain, time domain, or some tag based domain.
Example tag domains are ‘r’, ‘g’, ‘b’ for the color dimension of RGB images, or
the <em>b</em>-values of a diffusion weighted MRI acquisition.
Slicing the <strong>Series</strong> array will also slice the <strong>axes</strong> property accordingly.</p>
<p>The import and export of data builds on three kind of plugins:</p>
<ul class="simple">
<li><p>Format: The coding/decoding of an image format like DICOM, NIfTI, etc.</p></li>
<li><p>Archive: The packing of individual files. Most typically the files reside in a filesystem. The zip archive plugin supports packing files in a zip archive.</p></li>
<li><p>Transport: Plugins to access local files, or files on remote servers like a DICOM server.</p></li>
</ul>
<p>The addressing of a source or destination follows a url specification, <em>e.g.</em>:</p>
<ul class="simple">
<li><p><a class="reference external" href="file:///local_directory">file:///local_directory</a> : Access a directory on local filesystem</p></li>
<li><p><a class="reference external" href="file:///zipfile.zip">file:///zipfile.zip</a> : Access a zip file on local filesystem</p></li>
<li><p><a class="reference external" href="file:///zipfile.zip/time">file:///zipfile.zip/time</a> : Access a folder in a local zip file</p></li>
<li><p>dicom://server:104/AETITLE : Access a DICOM server on port 104 with given application entity title.</p></li>
</ul>
<p>The plugin architecture is depicted in the Figure here.</p>
<img alt="_images/Plugin_Architecture.png" src="_images/Plugin_Architecture.png" />
</div>
<div class="section" id="series-class">
<h1>Series Class<a class="headerlink" href="#series-class" title="Permalink to this headline"></a></h1>
<p>The Series class holds an image series (3D or multi-dimensional) loaded
or produced in Python. Figure 1 shows the steps to instantiate an image
series :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;</span>&gt;&gt; from imagedata import Series
<span class="gp">&gt;</span>&gt;&gt; <span class="nv">si</span> <span class="o">=</span> Series<span class="o">(</span>’dicom/volume/’<span class="o">)</span>
<span class="gp">&gt;</span>&gt;&gt; print<span class="o">(</span>si.shape, si.dtype<span class="o">)</span>
<span class="gp gp-VirtualEnv">(16, 160, 160)</span> <span class="go">uint16</span>
<span class="gp">&gt;</span>&gt;&gt; si.spacing
<span class="go">Array([2.    ,  1.3125,  1.3125])</span>
<span class="gp">&gt;</span>&gt;&gt; si.sliceLocations
<span class="go">array([ -3.16799537,  -1.16799537,   0.83200463,   2.83200463,</span>
<span class="go">         4.83200463,   6.83200463,   8.83200463,  10.83200463,</span>
<span class="go">        12.83200463,  14.83200463,  16.83200463,  18.83200463,</span>
<span class="go">        20.83200463,  22.83200463,  24.83200463,  26.83200463])</span>

<span class="gp">&gt;</span>&gt;&gt; <span class="c1"># Save series in output/ directory, original format</span>
<span class="gp">&gt;</span>&gt;&gt; si.input_format
<span class="go">’dicom’</span>
<span class="gp">&gt;</span>&gt;&gt; si.write<span class="o">(</span>’output/’<span class="o">)</span>
<span class="gp">&gt;</span>&gt;&gt; <span class="c1"># Save series in ITK format (MHA format by default)</span>
<span class="gp">&gt;</span>&gt;&gt; si.write<span class="o">(</span>’itk_output/’, <span class="nv">formats</span><span class="o">=[</span>’itk’<span class="o">])</span>
</pre></div>
</div>
<p>The addressing of the Series array is row-major (also known as C order),
which leads to the most efficient NumPy processing. E.g.  (slice, row,
column) in the 3D case, and (tag, slice, row, column) in the 4D case.
This is contrary to e.g. MATLAB (The MathWorks, Inc.) which addresses
arrays in column-major (Fortran) order. Also note that NumPy indices
start at zero, while MATLAB indices start at one.</p>
<p>The tag index for a 4D series indicates any attribute that distinguishes
the 3D volumes, like time for a dynamic scan, b value for a diffusion
weighted scan, flip angle or echo time for contrast weighted scans.</p>
<p>In a pipeline where non-DICOM data are converted to DICOM data, a DICOM
template is required to fill in missing attribute values.  The original
input DICOM images can usually be applied as template, such that a PACS
will add the new images as a new series to an existing patient and
study. Figure 1 shows an example where the loaded DICOM data are written
to files in both original (DICOM) and ITK’s MetaImage formats.</p>
<p>Like the ndarray, the Series object can be sliced. The imagedata package
attempts to maintain the geometry of the sliced data. The example in
Figure 2 extracts slice 5, showing that the sliceLocations attribute has
been adjusted. Next, slice 5 is stored to disk:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;</span>&gt;&gt; <span class="c1"># Extract _slice no. 5</span>
<span class="gp">&gt;</span>&gt;&gt; <span class="nv">slice5</span> <span class="o">=</span> si<span class="o">[</span><span class="m">5</span>,…<span class="o">]</span>
<span class="gp">&gt;</span>&gt;&gt; slice5.sliceLocations
<span class="go">array(6.8320046343748)</span>
<span class="gp">&gt;</span>&gt;&gt; <span class="c1"># Save _slice 5 to slice5/ directory</span>
<span class="gp">&gt;</span>&gt;&gt; slice5.write<span class="o">(</span>’slice5/’<span class="o">)</span>
</pre></div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Notebook.html" class="btn btn-neutral float-left" title="Jupyter Notebook" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Input_output.html" class="btn btn-neutral float-right" title="Input/output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2023, Erling Andersen, Haukeland University Hospital, Bergen, Norway.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>