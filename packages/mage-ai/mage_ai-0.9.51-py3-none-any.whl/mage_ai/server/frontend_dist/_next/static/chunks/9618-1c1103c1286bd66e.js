"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9618],{29618:function(n,e,t){t.d(e,{Z:function(){return j}});var o=t(82394),i=t(75582),r=t(17717),l=t(82684),u=t(80329),c=t(69864),a=t(40761),d=t(44425),s=t(71180),A=t(38626),f=t(97618),R=t(55485),T=t(28598),O=A.default.div.withConfig({displayName:"ButtonGroup__ButtonGroupStyle",componentId:"sc-15vbmc8-0"})([""]),E=A.default.div.withConfig({displayName:"ButtonGroup__VerticalDivider",componentId:"sc-15vbmc8-1"})(["width:1px;"]),p=function(n){var e=n.children,t=n.divider,o=l.Children.toArray(e).length;return(0,T.jsx)(O,{children:(0,T.jsx)(R.ZP,{children:l.Children.map(e,(function(n,e){return n&&(0,T.jsxs)(f.Z,{children:[e>=1&&t&&(0,T.jsx)(E,{}),l.cloneElement(n,{borderRadiusLeft:o>=2&&0===e,borderRadiusRight:o>=2&&e===o-1,halfPaddingLeft:o>=2&&0!==e,halfPaddingRight:o>=2&&e!==o-1,noBorder:o>=2&&e>0&&e<o-1,noBorderRight:o>=2&&e!==o-1})]},"button-group-child-".concat(e))}))})})},v=t(75810),D=t(89706),h=t(93369),S=t(57653),C=t(38276),L=t(35686),N=t(39643),P=t(11498),_=t(85385),Z=t(68669),b=t(86735),M=t(53005),m=t(81728),k=t(72619),g=t(42041),y=t(44688);function w(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}function I(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?w(Object(t),!0).forEach((function(e){(0,o.Z)(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var j=function(n){var e=n.active,t=n.addNewBlock,A=n.disableRefreshWarning,f=n.fetchPipeline,O=n.fetchVariables,E=n.filePath,w=n.hideHeaderButtons,j=n.onContentChange,U=n.onUpdateFileSuccess,x=n.openSidekickView,B=n.pipeline,H=n.saveFile,X=n.selectedFilePath,F=n.sendTerminalMessage,K=n.setDisableShortcuts,Y=n.setErrors,W=n.setFilesTouched,G=n.setSelectedBlock,Q=(0,u.j)("apiReloads"),V=(0,i.Z)(Q,2)[1],q=(0,l.useState)(null),J=q[0],z=q[1],$=(0,l.useState)(!1),nn=$[0],en=($[1],(0,l.useRef)(null)),tn=(0,l.useMemo)((function(){return new a.Z}),[]),on=(0,l.useMemo)((function(){return{api_key:P.lG,token:tn.decodedToken.token}}),[tn]),rn=L.ZP.statuses.list().data,ln=(0,l.useMemo)((function(){var n,e;return null===rn||void 0===rn||null===(n=rn.statuses)||void 0===n||null===(e=n[0])||void 0===e?void 0:e.repo_path}),[rn]),un=L.ZP.file_contents.detail(E).data;(0,l.useEffect)((function(){null!==un&&void 0!==un&&un.file_content?z(un.file_content):null!==un&&void 0!==un&&un.error&&(0,k.h$)(un,{onErrorCallback:function(n,e){return Y({errors:e,response:n})}})}),[un,Y]);var cn=(0,l.useState)(null===J||void 0===J?void 0:J.content),an=cn[0],dn=cn[1],sn=(0,l.useCallback)((function(n){dn(n),j&&(null===j||void 0===j||j(n))}),[j]),An=(0,l.useState)(!1),fn=An[0],Rn=An[1];(0,l.useEffect)((function(){e&&K&&(null===K||void 0===K||K(!0))}),[e,K]),(0,l.useEffect)((function(){var n;X&&(null===en||void 0===en||null===(n=en.current)||void 0===n||n.scrollIntoView())}),[X]);var Tn=(0,c.Db)(L.ZP.file_contents.useUpdate((null===J||void 0===J?void 0:J.path)&&encodeURIComponent(null===J||void 0===J?void 0:J.path)),{onSuccess:function(n){return(0,k.wD)(n,{callback:function(n){var e=n.file_content;V((function(n){return I(I({},n),{},(0,o.Z)({},"FileVersions/".concat(null===J||void 0===J?void 0:J.path),Number(new Date)))})),U&&(null===U||void 0===U||U(e))},onErrorCallback:function(n,e){return null===Y||void 0===Y?void 0:Y({errors:e,response:n})}})}}),On=(0,i.Z)(Tn,1)[0],En=(0,l.useCallback)((function(n,e){if(H)return H(n,e);On({file_content:I(I({},e),{},{content:n})}).then((function(){decodeURIComponent(E).split(r.sep).pop()===D.dT.METADATA_YAML&&O&&(null===O||void 0===O||O())})),W((function(n){return I(I({},n),{},(0,o.Z)({},null===e||void 0===e?void 0:e.path,!1))})),Rn(!1)}),[O,E,H,W,On]),pn=(0,l.useMemo)((function(){return(0,Z.lU)()}),[]),vn=(0,l.useMemo)((function(){var n,e,t,o;return null===(null===J||void 0===J||null===(n=J.path)||void 0===n?void 0:n.match(pn))?D.Lu.TXT:null===J||void 0===J||null===(e=J.path)||void 0===e||null===(t=e.match(pn))||void 0===t||null===(o=t[0])||void 0===o?void 0:o.split(".")[1]}),[pn,J]),Dn=(0,l.useMemo)((function(){if(null!==J&&void 0!==J&&J.path)return(0,T.jsx)(v.Z,{autoHeight:!0,language:D.nB[vn],onChange:function(n){sn(n),W((function(n){return I(I({},n),{},(0,o.Z)({},null===J||void 0===J?void 0:J.path,!0))})),Rn(!0)},onSave:function(n){En(n,J)},padding:10,selected:!0,textareaFocused:!0,value:(0,m.Pb)(null===J||void 0===J?void 0:J.content)?JSON.stringify(JSON.parse(null===J||void 0===J?void 0:J.content),null,2):null===J||void 0===J?void 0:J.content,width:"100%"})}),[J,vn,En,sn,W]),hn=null!==B&&void 0!==B&&B.blocks?(0,b.sE)(null===B||void 0===B?void 0:B.blocks,(function(n){var e=n.type;return d.tf.DATA_EXPORTER===e})):null,Sn=(0,c.Db)(L.ZP.blocks.pipelines.useUpdate(null===B||void 0===B?void 0:B.uuid,null===hn||void 0===hn?void 0:hn.uuid),{onSuccess:function(n){return(0,k.wD)(n,{callback:function(){null===f||void 0===f||f()}})}}),Cn=(0,i.Z)(Sn,1)[0],Ln=t&&B&&(vn===D.Lu.PY||vn===D.Lu.SQL||(vn===D.Lu.YAML||vn===D.Lu.R)&&(0,M.V3)(J,null===J||void 0===J?void 0:J.path))&&(0,Z.ck)(J.path.split(r.sep))!==d.tf.SCRATCHPAD&&(0,M.lr)(J)&&(0,T.jsx)(s.ZP,{onClick:function(){var n=(null===B||void 0===B?void 0:B.type)===S.qL.INTEGRATION,e=(0,Z.TU)(J,ln,B);t(e,(function(e){n&&hn&&Cn({block:I(I({},hn),{},{upstream_blocks:[e.uuid]})}),null===G||void 0===G||G(e)}))},primary:!0,children:"Add to current pipeline"}),Nn=F&&(0,T.jsx)(C.Z,{m:2,children:(0,T.jsx)(h.ZP,{disabled:!ln,inline:!0,loading:nn,onClick:function(){null===x||void 0===x||x(_.cH.TERMINAL),null===F||void 0===F||F(JSON.stringify(I(I({},on),{},{command:["stdin","pip install -r ".concat(ln,"/requirements.txt\r")]})))},title:ln?"Pip install packages from your saved requirements.txt file (\u2318+S to save).":"Please use right panel terminal to install packages.",uuid:"FileEditor/InstallPackages",children:"Install packages"})}),Pn="FileEditor/".concat(null===J||void 0===J?void 0:J.path),_n=(0,y.y)(),Zn=_n.registerOnKeyDown,bn=_n.unregisterOnKeyDown;return(0,l.useEffect)((function(){return function(){bn(Pn)}}),[bn,Pn]),Zn(Pn,(function(n,t){if(e&&!A)if((0,g.y)([N.zX,N.Um],t)||(0,g.y)([N.PQ,N.Um],t))n.preventDefault(),En(an,J);else if(fn&&(0,g.y)([N.zX,N.hS],t)){n.preventDefault();var o="".concat(J.path," has changes that are unsaved. ")+"Click cancel and save your changes before reloading page.";"undefined"!==typeof location&&window.confirm(o)&&location.reload()}}),[e,an,A,J,En,fn]),(0,T.jsxs)("div",{ref:en,children:[!w&&(0,T.jsx)(C.Z,{p:2,children:(0,T.jsxs)(R.ZP,{justifyContent:"space-between",children:[(0,T.jsxs)(p,{children:[Ln,(0,T.jsx)(s.ZP,{disabled:!an,onClick:function(n){n.preventDefault(),En(an,J)},title:an?null:"No changes have been made to this file.",children:"Save file content"})]}),x&&(0,T.jsx)(p,{children:(0,T.jsx)(s.ZP,{compact:!0,onClick:function(){x(_.cH.FILE_VERSIONS)},small:!0,title:"View previous changes to this file.",children:"Show versions"})})]})}),Dn,E===D.dT.REQS_TXT&&Nn]})}},44425:function(n,e,t){t.d(e,{$W:function(){return E},DA:function(){return T},HX:function(){return h},J8:function(){return D},L8:function(){return u},LE:function(){return A},Lk:function(){return L},Lq:function(){return f},M5:function(){return R},Q3:function(){return p},Qj:function(){return S},Ut:function(){return _},V4:function(){return P},VZ:function(){return v},dO:function(){return s},f2:function(){return N},iZ:function(){return C},t6:function(){return c},tf:function(){return d}});var o,i,r,l,u,c,a=t(82394);!function(n){n.CONDITION="condition",n.DBT_SNAPSHOT="snapshot",n.DYNAMIC="dynamic",n.DYNAMIC_CHILD="dynamic_child",n.REDUCE_OUTPUT="reduce_output",n.REPLICA="replica"}(u||(u={})),function(n){n.MARKDOWN="markdown",n.PYTHON="python",n.R="r",n.SQL="sql",n.YAML="yaml"}(c||(c={}));var d,s=(o={},(0,a.Z)(o,c.MARKDOWN,"MD"),(0,a.Z)(o,c.PYTHON,"PY"),(0,a.Z)(o,c.R,"R"),(0,a.Z)(o,c.SQL,"SQL"),(0,a.Z)(o,c.YAML,"YAML"),o),A=(i={},(0,a.Z)(i,c.MARKDOWN,"Markdown"),(0,a.Z)(i,c.PYTHON,"Python"),(0,a.Z)(i,c.R,"R"),(0,a.Z)(i,c.SQL,"SQL"),(0,a.Z)(i,c.YAML,"YAML"),i);!function(n){n.CALLBACK="callback",n.CHART="chart",n.CONDITIONAL="conditional",n.CUSTOM="custom",n.DATA_EXPORTER="data_exporter",n.DATA_LOADER="data_loader",n.DBT="dbt",n.EXTENSION="extension",n.GLOBAL_DATA_PRODUCT="global_data_product",n.SCRATCHPAD="scratchpad",n.SENSOR="sensor",n.MARKDOWN="markdown",n.TRANSFORMER="transformer"}(d||(d={}));var f,R=[d.CALLBACK,d.CONDITIONAL,d.EXTENSION];!function(n){n.BLUE="blue",n.GREY="grey",n.PINK="pink",n.PURPLE="purple",n.TEAL="teal",n.YELLOW="yellow"}(f||(f={}));var T,O,E=[d.CHART,d.CUSTOM,d.DATA_EXPORTER,d.DATA_LOADER,d.SCRATCHPAD,d.SENSOR,d.MARKDOWN,d.TRANSFORMER],p=[d.CUSTOM,d.DATA_EXPORTER,d.DATA_LOADER,d.SCRATCHPAD,d.SENSOR,d.MARKDOWN,d.TRANSFORMER],v=[d.DATA_EXPORTER,d.DATA_LOADER],D=[d.DATA_EXPORTER,d.DATA_LOADER,d.TRANSFORMER],h=[d.DATA_EXPORTER,d.DATA_LOADER,d.DBT,d.TRANSFORMER],S=[d.CHART,d.SCRATCHPAD,d.SENSOR,d.MARKDOWN],C=[d.CALLBACK,d.CHART,d.EXTENSION,d.SCRATCHPAD,d.MARKDOWN],L=[d.CUSTOM,d.DATA_EXPORTER,d.DATA_LOADER,d.SENSOR,d.TRANSFORMER];!function(n){n.EXECUTED="executed",n.FAILED="failed",n.NOT_EXECUTED="not_executed",n.UPDATED="updated"}(T||(T={})),function(n){n.BLOCK_FILE="block_file",n.CUSTOM_BLOCK_TEMPLATE="custom_block_template",n.MAGE_TEMPLATE="mage_template"}(O||(O={}));var N=[d.CUSTOM,d.DATA_EXPORTER,d.DATA_LOADER,d.TRANSFORMER],P=(r={},(0,a.Z)(r,d.CALLBACK,"Callback"),(0,a.Z)(r,d.CHART,"Chart"),(0,a.Z)(r,d.CONDITIONAL,"Conditional"),(0,a.Z)(r,d.CUSTOM,"Custom"),(0,a.Z)(r,d.DATA_EXPORTER,"Data exporter"),(0,a.Z)(r,d.DATA_LOADER,"Data loader"),(0,a.Z)(r,d.DBT,"DBT"),(0,a.Z)(r,d.EXTENSION,"Extension"),(0,a.Z)(r,d.GLOBAL_DATA_PRODUCT,"Global data product"),(0,a.Z)(r,d.MARKDOWN,"Markdown"),(0,a.Z)(r,d.SCRATCHPAD,"Scratchpad"),(0,a.Z)(r,d.SENSOR,"Sensor"),(0,a.Z)(r,d.TRANSFORMER,"Transformer"),r),_=[d.DATA_LOADER,d.TRANSFORMER,d.DATA_EXPORTER,d.SENSOR];l={},(0,a.Z)(l,d.DATA_EXPORTER,"DE"),(0,a.Z)(l,d.DATA_LOADER,"DL"),(0,a.Z)(l,d.SCRATCHPAD,"SP"),(0,a.Z)(l,d.SENSOR,"SR"),(0,a.Z)(l,d.MARKDOWN,"MD"),(0,a.Z)(l,d.TRANSFORMER,"TF")},80329:function(n,e,t){t.d(e,{j:function(){return o}});var o=(0,t(44152).r)({apiReloads:{}}).useGlobalState}}]);